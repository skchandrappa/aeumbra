# Deployment Guide - Free Hosting Options

## ðŸŽ¯ Best Free Hosting Options for FastAPI Backend

### 1. **Railway** (RECOMMENDED) â­
- âœ… Free tier: $5 free credit monthly
- âœ… PostgreSQL database included
- âœ… Auto-deployment from GitHub
- âœ… HTTPS enabled automatically
- âœ… Easy environment variable management

### 2. **Render**
- âœ… Free tier available (spins down after inactivity)
- âœ… PostgreSQL database included
- âœ… Auto-deployment from GitHub
- âœ… HTTPS enabled automatically

### 3. **Fly.io**
- âœ… Free tier with generous limits
- âœ… Global edge deployment
- âœ… PostgreSQL database support
- âš ï¸ Requires more configuration

### 4. **Vercel**
- âš ï¸ Serverless (not ideal for long-running connections)
- âœ… Edge functions support
- âœ… Very fast global CDN

---

## ðŸš€ Quick Deploy to Railway

### Step 1: Prepare Your Project

Create a `Procfile` (if not exists):
```bash
cd pythonbackend
echo "uvicorn main:app --host 0.0.0.0 --port \$PORT" > Procfile
```

### Step 2: Create `requirements.txt`

Create a comprehensive `requirements.txt` file:

```txt
fastapi==0.104.1
uvicorn[standard]==0.24.0
sqlalchemy[asyncio]==2.0.23
asyncpg==0.29.0
psycopg2-binary==2.9.9
pydantic==2.5.0
pydantic-settings==2.1.0
python-jose[cryptography]==3.3.0
passlib[bcrypt]==1.7.4
python-multipart==0.0.6
python-dotenv==1.0.0
```

### Step 3: Create `.env.example` file

```bash
cat > .env.example << 'EOF'
# Database
DATABASE_URL=postgresql+asyncpg://postgres:password@localhost:5432/aeumbre

# JWT
SECRET_KEY=your-secret-key-change-in-production
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# CORS
ALLOWED_HOSTS=*

# Environment
ENVIRONMENT=production
DEBUG=False
EOF
```

### Step 4: Deploy to Railway

1. Go to [Railway.app](https://railway.app)
2. Click "New Project" â†’ "Deploy from GitHub repo"
3. Select your `aeumbra` repository
4. Railway will detect the `railway.json` configuration
5. Add environment variables:
   - `DATABASE_URL` (will be auto-generated by Railway PostgreSQL)
   - `SECRET_KEY` (generate a strong secret key)
   - `ALGORITHM=HS256`
   - `ACCESS_TOKEN_EXPIRE_MINUTES=30`
   - `REFRESH_TOKEN_EXPIRE_DAYS=7`
   - `ENVIRONMENT=production`
   - `DEBUG=False`

6. Railway will automatically:
   - Install dependencies from `requirements.txt`
   - Run migrations
   - Start your FastAPI app

### Step 5: Set Up Database

Railway will automatically create a PostgreSQL database. Get the connection string from the database service's "Connect" tab.

### Step 6: Get Your Production URL

Railway will provide a URL like: `https://your-app.railway.app`

---

## ðŸš€ Alternative: Deploy to Render

### Step 1: Prepare Your Project

Same as Railway - ensure `requirements.txt` exists.

### Step 2: Create `render.yaml`

```yaml
services:
  - type: web
    name: aeumbra-backend
    runtime: python
    buildCommand: pip install -r requirements.txt
    startCommand: uvicorn main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: ENVIRONMENT
        value: production
      - key: DEBUG
        value: False
      - key: ALGORITHM
        value: HS256
      - key: ACCESS_TOKEN_EXPIRE_MINUTES
        value: 30
      - key: REFRESH_TOKEN_EXPIRE_DAYS
        value: 7

  - type: pspg
    name: aeumbra-db
    plan: free
```

### Step 3: Deploy to Render

1. Go to [Render.com](https://render.com)
2. Click "New" â†’ "Blueprint"
3. Connect your GitHub repository
4. Render will automatically deploy

---

## ðŸ“ Important Notes

### CORS Configuration

Update your `main.py` to allow your frontend domain:

```python
# In main.py
from fastapi.middleware.cors import CORSMiddleware

app.add_middleware(
    CORSMiddleware,
    allow_origins=[
        "http://localhost:3000",  # Development
        "https://your-frontend.vercel.app",  # Production frontend
    ],
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### Environment Variables

Never commit sensitive keys to GitHub. Use environment variables for:
- Database credentials
- JWT secrets
- API keys

### Database Migrations

If you have migrations, Railway and Render will automatically run them. Make sure your database initialization is in the startup event.

---

## ðŸ”— Frontend Deployment

Deploy your React frontend to **Vercel** (best option):

1. Go to [Vercel.com](https://vercel.com)
2. Import your GitHub repository
3. Set environment variables:
   - `REACT_APP_API_URL=https://your-backend.railway.app`
4. Deploy!

---

## ðŸŽ¯ Production Checklist

- [ ] Update CORS to allow production frontend domain
- [ ] Set strong `SECRET_KEY` in production
- [ ] Enable database backups
- [ ] Set up monitoring/logging
- [ ] Configure custom domain (optional)
- [ ] Test all API endpoints
- [ ] Update frontend API URL

---

## ðŸ“Š Comparison

| Feature | Railway | Render | Fly.io |
|---------|---------|--------|--------|
| Free Tier | $5/month credit | Limited | Generous |
| PostgreSQL | âœ… | âœ… | âœ… |
| Auto-deploy | âœ… | âœ… | âœ… |
| HTTPS | âœ… | âœ… | âœ… |
| Custom Domain | âœ… | âœ… | âœ… |
| Easy Setup | â­â­â­ | â­â­â­ | â­â­ |

---

## ðŸ†˜ Troubleshooting

### Database Connection Issues
- Check `DATABASE_URL` format: `postgresql+asyncpg://user:password@host:port/dbname`
- Ensure SSL is enabled in production: `?sslmode=require`

### Build Failures
- Check `requirements.txt` for all dependencies
- Ensure Python version is specified

### Performance Issues
- Use connection pooling
- Enable caching where possible
- Monitor database query performance

